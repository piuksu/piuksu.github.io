<html>
<head>
<title>PFM1 ametlik teisendaja - PFM - Piuksu</title>
<link rel="icon" href="/logo2.png">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="/style/PFM_.css">
<link rel="stylesheet" href="/style/PFM_t1.css">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="keywords" content="PFM1, #piuksu, PFM1 file, #PFM1, PFM, #PFM, photo, pilt, Piuksu">
<meta name="description" content='PFM1 on piuksu PFM Pildivorming.'>
<meta name="author" content="Rasmus Luure (Ã„itah w3schools-ile (https://www.w3schools.com/) ja stackoverflow-le (https://stackoverflow.com/))">
<body>
<h1 class="c">PFM</h1>
<h3 class="c">Piuksu - Failid - Meedia</h3>
<div class="nav">
<a href="/PFM/">Kodu</a>
<a href="1t.html">PFM1 teisendaja</a>
<a href="/">Piuksu koduleht</a>
</div>
<div id="kood" class="v">
<h1>Sisestage PFM1 kood siia:</h1>
<textarea id="texta"></textarea>
<br><br><br>
<button id="btn" onclick="jv('lakood');">Lae alla</button>
<br><br><br>
<!--<button id="btnr" onclick="jv('url');">Sisesda URL</button>-->
</div>
<div id="url" class="hide v">
<h1>Sisestage PFM1 url siia:</h1>
<input id="inpu" class="inp">
<br><br><br>
<button id="btn" onclick="jv('laurl');">Lae alla</button>
<br><br><br>
<button id="btnr" onclick="jv('kood');">Sisesda PFM1 kood</button>
</div>
<div id="lakood" class="hide v">
<h1>Nimi:</h1>
<input id="inpa" class="inp">
<br><br><br>
<button id="btn" onclick="tolgi(document.getElementById('texta').value);lapng(document.getElementById('inpa').value);">Teisenda .png</button>
<br><br><br>
<a href="PFM1-teisendaja.html"><button id="btnr">Sisesta veel PFM1 koodi</button></a>
</div>
<div id="laurl" class="hide v">
<br><br><br>
<button id="btn" onclick="lurl();">Teisenda .png</button>
<br><br><br>
<a href="PFM1-teisendaja.html"><button id="btnr">Sisesta veel URL-e</button></a>
</div>
<div class="hide">
<a id="link"></a>
<iframe id="ifr"></iframe>
<canvas id="canvas">
</div>
<script>
function lurl() {
  var ifr = document.getElementById('ifr');
  ifr.src = document.getElementById('inpu').value;
  tolgi(ifr.contentwindow.document.innerHTML);
  lapng();
}
function jv(id) {
  var vs = document.getElementsByClassName("v");
  var i;
  for (i = 0; i < vs.length; i++) {
    vs[i].style.display = "none";
  }
  document.getElementById(id).style.display = "block";
}
var canvas = document.getElementById("canvas");
function tolgi(code) {
  var SAA = code.indexOf(":");
  var SKA = code.indexOf("!");
  var SLA = code.indexOf(";");
  var WI = code.slice(SAA + 1,SKA);
  var HE = code.slice(SKA + 1, SLA);
  canvas.width = WI;
  canvas.height = HE;
  var PXASA = code.match(/./g);
  PXA = code.indexOf(".", 0);
  PXL = code.indexOf(",", PXA);
  var PXV = code.slice(PXA + 1,PXL);
  kuva(PXV, canvas.width, canvas.height);
  for (let i = 0; i < PXASA.length; i++) {
      PXA = code.indexOf(".", PXL);
      PXL = code.indexOf(",", PXA);
      PXV = code.slice(PXA + 1,PXL);
      kuva(PXV, canvas.width, canvas.height);
  }
}
function lapng(nimi) {
  var link = document.getElementById('link');
  link.setAttribute('download', nimi + '.png');
  link.setAttribute('href', canvas.toDataURL("image/png").replace("image/png", "image/octet-stream"));
  link.click();
}
function lajpg(nimi) {
  var link = document.getElementById('link');
  link.setAttribute('download', nimi + '.jpg');
  link.setAttribute('href', canvas.toDataURL("image/jpeg").replace("image/jpeg", "image/octet-stream"));
  link.click();
}
function lagif(nimi) {
  var link = document.getElementById('link');
  link.setAttribute('download', nimi + '.gif');
  link.setAttribute('href', canvas.toDataURL("image/gif").replace("image/gif", "image/octet-stream"));
  link.click();
}
var a = -1;
var b = 0;
function kuva(varv, ap, bp) {
  ap = ap - 1;
  bp = bp - 1;
  if (a == ap) {a = -1; if (b != bp) {b++;}}
  a++;
  var canvas = document.getElementById("canvas");
  var ctx = canvas.getContext("2d");
  ctx.fillStyle = varv;
  ctx.fillRect(a,b,1,1);
}
</script>
</body>
</head>
</html>

